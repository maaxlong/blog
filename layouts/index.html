{{ define "main" }}
<div class="content-with-sidebar">
  <div class="main-content">

    {{/* Use posts (post/posts sections), newest first */}}
    {{ $posts := where site.RegularPages "Section" "in" (slice "post" "posts") }}
    {{ range first 10 ($posts.ByDate.Reverse) }}
    <article class="post-summary">
      <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>

      <p class="post-meta">
        <time>{{ .Date | time.Format "2 January 2006, 3:04 pm" }}</time>
        {{ with .Params.tags }}
          &nbsp;·&nbsp;
          {{ $n := sub (len .) 1 }}
          {{ range $i, $tag := . }}
            {{ if $i }}, {{ end }}
            <a class="tag-link-inline" href="{{ "tags/" | relLangURL }}{{ $tag | urlize }}/">#{{ $tag }}</a>
          {{ end }}
        {{ end }}
      </p>

      {{ with .Summary }}
      <div class="home-post-content">
        {{ . | safeHTML }}
      </div>
      {{ end }}

      {{/* Show Read more if the summary is truncated OR the post is long */}}
      {{ if or .Truncated (gt .WordCount 600) }}
        <a class="read-more" href="{{ .Permalink }}">Read more →</a>
      {{ end }}
    </article>
    {{ end }}

  </div>

  {{ partial "sidebar.html" . }}
</div>
{{ end }}